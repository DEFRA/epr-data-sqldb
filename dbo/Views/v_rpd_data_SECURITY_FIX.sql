CREATE VIEW [v_rpd_data_SECURITY_FIX]
AS SELECT DISTINCT sec.[Organisations_Id]
      ,sec.[FromOrganisation_TypeId]
      ,sec.[FromOrganisation_Type]
      ,sec.[FromOrganisation_CompaniesHouseNumber]
      ,sec.[FromOrganisation_Name]
      ,sec.[FromOrganisation_TradingName]
      ,sec.[FromOrganisation_ReferenceNumber]
      ,sec.[FromOrganisation_SubBuildingName]
      ,sec.[FromOrganisation_BuildingName]
      ,sec.[FromOrganisation_BuildingNumber]
      ,sec.[FromOrganisation_Street]
      ,sec.[FromOrganisation_Locality]
      ,sec.[FromOrganisation_DependentLocality]
      ,sec.[FromOrganisation_Town]
      ,sec.[FromOrganisation_County]
      ,sec.[FromOrganisation_Country]
      ,sec.[FromOrganisation_Postcode]
      ,sec.[FromOrganisation_ValidatedWithCompaniesHouse]
      ,sec.[FromOrganisation_IsComplianceScheme]
      ,sec.[FromOrganisation_NationId]
      ,sec.[Organisations_CreatedOn]
      ,sec.[FromOrganisation_IsDeleted]
      ,sec.[FromOrganisation_ProducerTypeId]
      ,sec.[FromOrganisation_TransferNationId]
      ,sec.[ToOrganisation_TypeId]
      ,sec.[ToOrganisation_Type]
      ,sec.[ToOrganisation_CompaniesHouseNumber]
      ,sec.[ToOrganisation_Name]
      ,sec.[ToOrganisation_TradingName]
      ,sec.[ToOrganisation_ReferenceNumber]
      ,sec.[ToOrganisation_SubBuildingName]
      ,sec.[ToOrganisation_BuildingName]
      ,sec.[ToOrganisation_BuildingNumber]
      ,sec.[ToOrganisation_Street]
      ,sec.[ToOrganisation_Locality]
      ,sec.[ToOrganisation_DependentLocality]
      ,sec.[ToOrganisation_Town]
      ,sec.[ToOrganisation_County]
      ,sec.[ToOrganisation_Country]
      ,sec.[ToOrganisation_Postcode]
      ,sec.[ToOrganisation_ValidatedWithCompaniesHouse]
      ,sec.[ToOrganisation_IsComplianceScheme]
      ,sec.[ToOrganisation_NationId]
      ,sec.[ToOrganisation_IsDeleted]
      ,sec.[ToOrganisation_ProducerTypeId]
      ,sec.[ToOrganisation_TransferNationId]
      ,sec.[OrganisationConnections_Id]
      ,sec.[OrganisationConnections_FromOrganisationId]
      ,sec.[OrganisationConnections_FromOrganisationRoleId]
      ,sec.[OrganisationConnections_ToOrganisationId]
      ,sec.[OrganisationConnections_ToOrganisationRoleId]
      ,sec.[OrganisationConnections_CreatedOn]
      ,sec.[OrganisationConnections_LastUpdatedOn]
      ,sec.[OrganisationConnections_IsDeleted]
      ,sec.[SelectedSchemes_Id]
      ,sec.[SelectedSchemes_OrganisationConnectionId]
      ,sec.[SelectedSchemes_ComplianceSchemeId]
      ,sec.[SelectedSchemes_CreatedOn]
      ,sec.[SelectedSchemes_LastUpdatedOn]
      ,sec.[SelectedSchemes_IsDeleted]
      ,sec.[ComplianceSchemes_Id]
      ,sec.[ComplianceSchemes_Name]
      ,sec.[ComplianceSchemes_CreatedOn]
      ,sec.[ComplianceSchemes_LastUpdatedOn]
      ,sec.[ComplianceSchemes_IsDeleted]
      ,sec.[ComplianceSchemes_CompaniesHouseNumber]
      ,sec.[InterOrganisationRoles_FromOrganisationRole]
      ,sec.[InterOrganisationRoles_ToOrganisationRole]
      ,sec.[PersonOrganisationConnections_Id]
      ,sec.[PersonOrganisationConnections_OrganisationId]
      ,sec.[PersonOrganisationConnections_JobTitle]
      ,sec.[PersonOrganisationConnections_ExternalId]
      ,sec.[PersonOrganisationConnections_CreatedOn]
      ,sec.[PersonOrganisationConnections_LastUpdatedOn]
      ,sec.[PersonOrganisationConnections_IsDeleted]
      ,sec.[OrganisationToPersonRoles_Role]
      ,sec.[PersonInOrganisationRoles_Role]
      ,sec.[Persons_Id]
      ,sec.[Persons_FirstName]
      ,sec.[Persons_LastName]
      ,sec.[Persons_Email]
      ,sec.[Persons_Telephone]
      ,sec.[Persons_CreatedOn]
      ,sec.[Persons_LastUpdatedOn]
      ,sec.[Persons_IsDeleted]
      ,sec.[Users_Email]
      ,sec.[Users_IsDeleted]
      ,sec.[Users_InviteToken]
      ,sec.[Users_InvitedBy]
      ,sec.[Enrolment_Id]
      ,sec.[Enrolment_ConnectionId]
      ,sec.[Enrolment_ServiceRoleId]
      ,sec.[Enrolment_ValidFrom]
      ,sec.[Enrolment_ValidTo]
      ,sec.[Enrolment_ExternalId]
      ,sec.[Enrolment_CreatedOn]
      ,sec.[Enrolment_LastUpdatedOn]
      ,sec.[Enrolment_IsDeleted]
      ,sec.[Enrolment_RegulatorCommentId]
      ,sec.[EnrolmentStatuses_EnrolmentStatus]
      ,sec.[ServiceRoles_Id]
      ,sec.[ServiceRoles_ServiceId]
      ,sec.[ServiceRoles_Key]
      ,sec.[ServiceRoles_Role]
      ,sec.[ServiceRoles_Description]
      ,sec.[Services_Key]
      ,sec.[Services_Service]
      ,sec.[Services_Description]
      ,sec.[DelegatedPersonEnrolment_RelationshipType]
      ,sec.[DelegatedPersonEnrolment_ConsultancyName]
      ,sec.[DelegatedPersonEnrolment_ComplianceSchemeName]
      ,sec.[DelegatedPersonEnrolment_OtherOrganisationNation]
      ,sec.[DelegatedPersonEnrolment_OtherRelationshipDescription]
      ,sec.[DelegatedPersonEnrolment_NominatorDeclaration]
      ,sec.[DelegatedPersonEnrolment_NominatorDeclarationTime]
      ,sec.[DelegatedPersonEnrolment_NomineeDeclaration]
      ,sec.[DelegatedPersonEnrolment_NomineeDeclarationTime]
      ,sec.[DelegatedPersonEnrolment_CreatedOn]
      ,sec.[DelegatedPersonEnrolment_LastUpdatedOn]
      ,sec.[DelegatedPersonEnrolment_IsDeleted]
      ,sec.[NominatedDelegatedPersonEnrolment_RelationshipType]
      ,sec.[NominatedDelegatedPersonEnrolment_ConsultancyName]
      ,sec.[NominatedDelegatedPersonEnrolment_ComplianceSchemeName]
      ,sec.[NominatedDelegatedPersonEnrolment_OtherOrganisationNation]
      ,sec.[NominatedDelegatedPersonEnrolment_OtherRelationshipDescription]
      ,sec.[NominatedDelegatedPersonEnrolment_NominatorDeclaration]
      ,sec.[NominatedDelegatedPersonEnrolment_NominatorDeclarationTime]
      ,sec.[NominatedDelegatedPersonEnrolment_NomineeDeclaration]
      ,sec.[NominatedDelegatedPersonEnrolment_NomineeDeclarationTime]
      ,sec.[NominatedDelegatedPersonEnrolment_CreatedOn]
      ,sec.[NominatedDelegatedPersonEnrolment_LastUpdatedOn]
      ,sec.[NominatedDelegatedPersonEnrolment_IsDeleted]
      ,sec.[FromOrganisation_NationName]
      ,sec.[ToOrganisation_NationName]
      ,sec.[Security_Id]
      ,unpvt.[SecurityQuery]
      ,NULL AS [SecurityQuery_OrganisationOrigin]
      ,sec.[ApprovedPerson_Id]
      ,sec.[ApprovedPerson_FirstName]
      ,sec.[ApprovedPerson_LastName]
      ,sec.[ApprovedPerson_Email]
      ,sec.[ApprovedPerson_Telephone]
      ,sec.[ApprovedPerson_CreatedOn]
      ,sec.[ApprovedPerson_LastUpdatedOn]
      ,sec.[ApprovedPerson_IsDeleted]
      ,sec.[ApprovedPerson_JobTitle]
      ,sec.[DelegatedPerson_Id]
      ,sec.[DelegatedPerson_FirstName]
      ,sec.[DelegatedPerson_LastName]
      ,sec.[DelegatedPerson_Email]
      ,sec.[DelegatedPerson_Telephone]
      ,sec.[DelegatedPerson_CreatedOn]
      ,sec.[DelegatedPerson_LastUpdatedOn]
      ,sec.[DelegatedPerson_IsDeleted]
      ,sec.[DelegatedPerson_JobTitle]

  FROM [dbo].[v_rpd_data_SECURITY_FIX_base] sec

  LEFT JOIN t_Producer_CS_Lookup_Unpivot unpvt
  ON sec.FromOrganisation_ReferenceNumber = unpvt.Producer_Id;